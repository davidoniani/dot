#!/usr/bin/env sh

# Bookmark manager
# by David Oniani <onianidavid@gmail.com>
# MIT License

path="${XDG_DATA_HOME:-$HOME/.local/share}/bookmark.txt"

add() {
    bookmark=$(wl-paste)
    if grep -q "^$bookmark$" "$path"; then
        notify-send "Bookmark already exists" "$bookmark"
    else
        printf "%s\n" "$bookmark" >> "$path"
        tmpfile=$(mktemp)
        sort -u "$path" > "$tmpfile" && mv "$tmpfile" "$path"
    fi
}

sel() {
    bookmark=$(rofi -dmenu -i < "$path")
    [ -z "$bookmark" ] && exit 0
    printf "%s\n" "$bookmark" | wl-copy
    wtype -M ctrl l -m ctrl && wtype -M ctrl -M shift v && wtype -k return
}

case $1 in
    -a) add;;
    -s) sel;;
    *) printf "Unknown command\n";;
esac
