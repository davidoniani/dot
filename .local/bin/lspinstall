#!/usr/bin/env sh

# Install language servers
# by David Oniani <onianidavid@gmail.com>
# License: MIT License

install_cpp() {
    os=$(uname -s | tr "[:upper:]" "[:lower:]")
    case $os in
        linux) sudo apt-get install clangd-12;;
        darwin) brew install llvm;;
    esac
}

install_rust() {
    os=$(uname -s | tr "[:upper:]" "[:lower:]")
    case $os in
        linux) git clone https://github.com/rust-analyzer/rust-analyzer.git && cd rust-analyzer &&
            cargo xtask install --server && cd .. && rm -rf rust-analyzer;;
        darwin) brew install rust-analyzer;;
    esac
}

case $1 in
    bash) sudo npm install -g bash-language-server;;
    cmake) python3 -m pip install -U cmake-language-server;;
    cpp) install_cpp;;
    efm) GO111MODULE=on go get github.com/mattn/efm-langserver;;
    go) GO111MODULE=on go get golang.org/x/tools/gopls@latest;;
    python) sudo npm install -g pyright;;
    rust) install_rust;;
    *) printf "Unknown language\n";;
esac
